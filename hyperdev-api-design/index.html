<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>HyperDev/API Documentation</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="https://cdn.datatables.net/1.10.23/css/jquery.dataTables.css"
    />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div style="display: flex; height: 100vh">
      <div class="container bg-brown">
        <h1 style="margin: 30px 0 10px 0; color: #66422c">
          API Design For Indigenous Project
        </h1>
        <h3 style="margin: 10px 0 80px 0; color: #66422c">By HyperDev</h3>
        <div style="max-height: 60vh !important; overflow-y: scroll !important">
          <table id="api-table" class="display">
            <thead>
              <tr>
                <th>API Name</th>
                <th>Type</th>
                <th>Target</th>
                <th>Url</th>
                <th>Need Token</th>
                <th></th>
              </tr>
            </thead>
            <tbody id="api-table-tbody"></tbody>
          </table>
        </div>
      </div>
      <div style="width: 40%">
        <img class="bg-indigenous" src="HyperDevLogo.png" />
      </div>
    </div>

    <!-- Modal -->
    <div class="modale" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-header">
          <h1 id="api-name"></h1>
          <a href="#" class="btn-close closemodale" aria-hidden="true"
            >&times;</a
          >
        </div>
        <div class="modal-body">
          <h2 id="api-url"></h2>
          <p id="api-description"></p>
          <p id="api-parameters"></p>
          <p id="api-token"></p>
        </div>
      </div>
    </div>

    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"
      integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg=="
      crossorigin="anonymous"
    ></script>
    <script src="https://use.fontawesome.com/3318fd59a6.js"></script>
    <script
      type="text/javascript"
      charset="utf8"
      src="https://cdn.datatables.net/1.10.23/js/jquery.dataTables.js"
    ></script>
    <script>
      $(document).ready(function () {
        let tbody = ``;
        let apiArray = [];
        $.getJSON("ApiDesign.json", function (json) {
          apiArray = json;
          json.forEach((api) => {
            tbody += `<tr>
                        <td>${api.name}</td>
                        <td><span class="api-type-${api.type}">${
              api.type
            }<span></td>
                        <td>${
                          api.target === "admin"
                            ? "Admin"
                            : api.target === "application"
                            ? "Mobile"
                            : "Mobile/Admin"
                        }</td>
                        <td>${api.url}</td>
                        <td>${
                          api.authorization
                            ? '<i style="color:green;" class="fa fa-check">'
                            : ""
                        }</td>
                        <td><a class="openmodale"  href="#"><i data-id="${
                          api.url
                        }" style="color:#9e7e5d;" class="fa fa-info-circle"></i></a></td>
                    </tr>`;
          });
          $("#api-table-tbody").append(tbody);
          $("#api-table").DataTable({
            pageLength: 10,
          });
          $(".openmodale").click(function (e) {
            let matchedApi = apiArray.find((api) => {
              return api.url === e.target.getAttribute("data-id");
            });
            $("#api-name").text("API: " + matchedApi.name);
            $("#api-url").html(matchedApi.url);
            $("#api-description").html(
              "<strong>Description: </strong></br>" + matchedApi.description
            );
            $("#api-parameters").html(
              "<strong>Parameters: </strong></br>" +
                (matchedApi.parameters.length
                  ? matchedApi.parameters.join(" - ")
                  : "No parameters needed")
            );
            $("#api-token").html(
              matchedApi.authorization
                ? '<strong style="padding:3px 10px;background-color:green;color:white">Need to include token in request</strong>'
                : ""
            );
            e.preventDefault();
            $(".modale").addClass("opened");
          });
          $(".closemodale").click(function (e) {
            e.preventDefault();
            $(".modale").removeClass("opened");
          });
        });
      });
    </script>
  </body>
</html>
